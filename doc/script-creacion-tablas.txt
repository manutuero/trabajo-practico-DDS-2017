/* Script de creacion base de datos MYSQL */
CREATE DATABASE `dbprod`;

CREATE TABLE `dbprod`.`Cuenta` 
	(`codigo` VARCHAR(50) NOT NULL PRIMARY KEY,
    `nombre` VARCHAR(150) NOT NULL) ENGINE = InnoDB;

CREATE TABLE `dbprod`.`Empresa` 
	(`nombre` VARCHAR(50) NOT NULL PRIMARY KEY) ENGINE = InnoDB;

CREATE TABLE `dbprod`.`Cotizacion`
	( id INT AUTO_INCREMENT PRIMARY KEY,
	`cuenta` VARCHAR(50) NOT NULL,
    `empresa` VARCHAR(50) NOT NULL,
 	`periodo` INT NOT NULL,
	`valor` DECIMAL NOT NULL,
	CONSTRAINT FOREIGN KEY (cuenta) REFERENCES Cuenta(codigo),
    CONSTRAINT FOREIGN KEY (empresa) REFERENCES Empresa(nombre),	
	CONSTRAINT UNIQUE (`cuenta`, `empresa`, `periodo`)) ENGINE = InnoDB;

CREATE TABLE `dbprod`.`Indicador`
	(`codigo` VARCHAR(50) NOT NULL PRIMARY KEY,
    `nombre` VARCHAR(50),
	`tipo` VARCHAR(50) NOT NULL,
	`formula` VARCHAR(255) NOT NULL) ENGINE = InnoDB;

CREATE TABLE `dbprod`.`Metodologia` 
	(`metCodigo` VARCHAR(50) NOT NULL PRIMARY KEY,
    `descripcion` VARCHAR(50) NOT NULL) ENGINE = InnoDB;

CREATE TABLE `dbprod`.`Condicion` 
 	(`condCodigo` VARCHAR(50) NOT NULL PRIMARY KEY,
    `nombre` VARCHAR(150) NOT NULL,
	`tipo` VARCHAR(50) NOT NULL,
  	`formula` VARCHAR(255) NOT NULL) ENGINE = InnoDB;

CREATE TABLE `dbprod` . `Metodologia_Condicion` 
	(`condicion` VARCHAR(50) NOT NULL,
    `metodologia`  VARCHAR(50) NOT NULL,
    PRIMARY KEY (condicion, metodologia),
    CONSTRAINT FOREIGN KEY (condicion) REFERENCES Condicion(condCodigo),
    CONSTRAINT FOREIGN KEY (metodologia) REFERENCES Metodologia(metCodigo))ENGINE = InnoDB;

INSERT INTO `dbprod`.`Empresa` (nombre) VALUES ('Facebook'),('Twitter');